[2024-05-03 00:31:13,532][__main__][INFO] - name: mcts_phase4
project: MCTS_Connect4
entity: filipinogambino
group: post_obs_bug_fix
weights_only: false
model_arch: conv_model
unexplored_action: 1.0e-05
enable_wandb: false
log_freq: 10
worker_type: optimize
seed: 42
learner_device: cpu
actor_device: cpu
batch_size: 1024
noise_eps: 0.25
c_puct: 0.5
dirichlet_alpha: 0.3
temperature_tau: 0.9
n_blocks: 12
hidden_dim: 128
embedding_dim: 16
kernel_size: 3
normalize: false
rescale_value_input: false
rescale_se_input: false
obs_space_kwargs: {}
reward_space_kwargs: {}
act_space: BasicActionSpace
obs_space: HistoricalObs
reward_space: GameResultReward
optimizer_class: Adam
optimizer_kwargs:
  lr: 3.0e-05
  eps: 0.0003
min_lr_mod: 0.002
search_threads: 10
max_processes: 1
simulation_num_per_move: 150
max_games_per_file: 100
self_play_games: 400
model_dir: models
current_model_weight_fname: mcts_phase3.pt
nextgen_model_weight_fname: mcts_phase4.pt
best_model_weight_fname: _best_model.pt
replace_rate: 0.55
eval_games: 100
play_data_dir: play_data/raw
play_data_filename_tmpl: play_%s.pkl
log_dir: logs
main_log_path: main.log
max_epochs: 50
use_mixed_precision: true
discounting: 0.999
reduction: mean
clip_grads: 10.0
checkpoint_freq: 10.0
num_learner_threads: 1
load_dir: null
n_value_warmup_batches: 0
debug: false

[2024-05-03 00:31:13,536][__main__][INFO] - Running: optimize
[2024-05-03 00:31:13,673][numexpr.utils][INFO] - NumExpr defaulting to 4 threads.
[2024-05-03 00:31:22,833][worker.optimize][INFO] - gamestate_df1.pkl loaded
[2024-05-03 00:31:31,823][worker.optimize][INFO] - gamestate_df2.pkl loaded
[2024-05-03 00:31:40,178][worker.optimize][INFO] - gamestate_df3.pkl loaded
[2024-05-03 00:31:50,128][worker.optimize][INFO] - gamestate_df4.pkl loaded
[2024-05-03 00:31:50,135][worker.optimize][INFO] - None
[2024-05-03 00:31:50,148][worker.optimize][INFO] -              prob_0        prob_1  ...        prob_6          vals
count  1.048700e+04  10487.000000  ...  1.048700e+04  10487.000000
mean   1.061104e-01      0.133032  ...  9.778959e-02      0.017450
std    2.737296e-01      0.289480  ...  2.665849e-01      0.916284
min    0.000000e+00      0.000000  ...  0.000000e+00     -1.000000
25%    1.350836e-10      0.000000  ...  7.267465e-11     -1.000000
50%    8.696329e-03      0.016361  ...  6.874211e-03      0.000000
75%    4.536602e-02      0.069477  ...  3.945892e-02      1.000000
max    1.000000e+00      1.000000  ...  1.000000e+00      1.000000

[8 rows x 8 columns]
[2024-05-03 00:31:50,175][worker.optimize][INFO] - Training on 10,487 datapoints for 50 epochs and batch size of 1024
[2024-05-03 00:31:50,264][worker.optimize][INFO] - Training model with 3,689,384 parameters
